<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../lib/triple-viewer/dist/triple-viewer.css">
    <script src="../../lib/triple-viewer/dist/triple-viewer.bundle.js"></script>
</head>

<body>
<div class="row" style="margin: 0px 20px;">
    <div id="nx-overview" class="col-md-12"></div>
</div>
<div class="row" style="margin: 0px 20px;">
    <div id="nx-isoformChoice" class="col-md-12" style="margin-bottom: -5px;"></div>
</div>
<div class="row" style="margin: 0px 20px;">
    <div id="visuContainer" class="col-md-12">
        <div id="isoformDisplayed"></div>
        <div class="chart"></div>
    </div>
</div>
<div class="row" style="margin: 10px 20px;">
    <div id="featuresTable" class="col-md-6"></div>
    <div class="col-md-6" style="padding-right:0px;">
        <div id="seqViewer"></div>
    </div>
</div>
</body>
<script>
    ($(function () {

        var Nextprot = window.Nextprot;
        var nx = new Nextprot.Client("nextprot structure view", "CALIPHO-Team");
        var entry = nx.getEntryName();

        $(function () {
            Promise.all([nx.getProteinSequence(entry),
                nx.getAnnotationsByCategory(entry, "interacting-region"),
                nx.getAnnotationsByCategory(entry, "miscellaneous-region"),
                nx.getAnnotationsByCategory(entry, "domain"),
                nx.getAnnotationsByCategory(entry, "repeat"),
                nx.getAnnotationsByCategory(entry, "calcium-binding-region"),
                nx.getAnnotationsByCategory(entry, "zinc-finger-region"),
                nx.getAnnotationsByCategory(entry, "dna-binding-region"),
                nx.getAnnotationsByCategory(entry, "nucleotide-phosphate-binding-region"),
                nx.getAnnotationsByCategory(entry, "coiled-coil-region"),
                nx.getAnnotationsByCategory(entry, "short-sequence-motif"),
                nx.getAnnotationsByCategory(entry, "compositionally-biased-region"),
                nx.getAnnotationsByCategory(entry, "topological-domain"),
                nx.getAnnotationsByCategory(entry, "transmembrane-region "),
                nx.getAnnotationsByCategory(entry, "miscellaneous-site"),
                nx.getAnnotationsByCategory(entry, "active-site"),
                nx.getAnnotationsByCategory(entry, "binding-site"),
                nx.getAnnotationsByCategory(entry, "cleavage-site"),
                nx.getAnnotationsByCategory(entry, "metal-binding-site"),
                nx.getAnnotationsByCategory(entry, "variant"),
                nx.getAnnotationsByCategory(entry, "mutagenesis"),
                nx.getAnnotationsByCategory(entry, "sequence-conflict"),
                nx.getAnnotationsByCategory(entry, "beta-strand"),
                nx.getAnnotationsByCategory(entry, "helix"),
                nx.getAnnotationsByCategory(entry, "turn"),
                nx.getIsoformMapping(entry)]).then(function (oneData) {

                var metaData = [
                    {name: "Sequence"},                                                                                              {name: "Interacting region",className: "intregion",color: "#B3C2F0",type: "rect",filter:"Region"},
                    {name: "Region",className: "miscregion",color: "#B3C2B3",type: "rect",filter:"Region"},                          {name: "Domain",className: "domain",color: "#B3C2C2",type: "rect",filter:"Region"},
                    {name: "Repeat",className: "repeat",color: "#98B7D5",type: "rect",filter:"Region"},                              {name: "Calcium binding",className: "calcium",color: "#B3C2E1",type: "rect",filter:"Region"},
                    {name: "Zinc finger",className: "calcium",color: "#B3C2E1",type: "rect",filter:"Region"},                        {name: "DNA binding",className: "dnabind",color: "#B3C2FF",type: "rect",filter:"Region"},
                    {name: "Nucleotide binding",className: "nucleobind",color: "#B3D1B3",type: "rect",filter:"Region"},              {name: "Coiled-coil",className: "coiledcoil",color: "#B3D1C2",type: "rect",filter:"Region"},
                    {name: "Sequence motif",className: "motif",color: "#B3D1D1",type: "rect",filter:"Region"},                       {name: "Composition bias",className: "biased",color: "#B3D1E1",type: "rect",filter:"Region"},
                    {name: "Top domain",className: "topodomain",color: "#A5DBA5",type: "rect",filter:"Topology"},                    {name: "Membrane",className: "membrane",color: "#A5DBB7",type: "rect",filter:"Topology"},
                    {name: "Site",className: "site",color: "#B3F0E1",type: "unique",filter:"Site"},                                  {name: "Active site",className: "actSite",color: "#B3F0F0",type: "unique",filter:"Site"},
                    {name: "Binding site",className: "bindsite",color: "#82E6FF",type: "unique",filter:"Site"},                      {name: "Cleavage site",className: "cleavsite",color: "#B3FFB3",type: "unique",filter:"Site"},
                    {name: "Metal binding",className: "metal",color: "#B3FFC2",type: "unique",filter:"Site"},                        {name: "Variant",className: "variant",color: "rgba(0,255,154,0.3)",type: "unique",filter:"Variant"},
                    {name: "Mutagenesis",className: "mutagenesis",color: "#73FFE3",type: "unique",filter:"Variant"},                 {name: "Conflict",className: "seqconflict",color: "#6FFFFF",type: "unique",filter:"Conflict"},
                    {name: "Beta strand",className: "betastrand",color: "#B3F0C2",type: "rect",filter:"Secondary structure"},        {name: "Helix",className: "helix",color: "#B3F0D1",type: "rect",filter:"Secondary structure"},
                    {name: "Turn",className: "turn",color: "#B3F0E1",type: "rect",filter:"Secondary structure"}

                ];

                var tv = new TripleViewer(entry);
                tv.init(oneData,metaData);

         }).catch(function (err) {
                // catch any error that happened so far
                console.log("Argh, broken: " + err.message);
                console.log("Error at line : " + err.stack);
            });
        });
    }));
</script>
</html>